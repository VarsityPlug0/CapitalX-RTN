{% extends "emails/base_email.html" %}

{% block subject %}ğŸ’¸ New Withdrawal Request - R{{ amount|floatformat:2 }} from {{ user.username }}{% endblock %}

{% block content %}
<div class="greeting">
    ğŸ’¸ New Withdrawal Request
</div>

<div class="main-content">
    <p>Hello Admin,</p>

    <p>A new withdrawal request has been submitted and is awaiting your review in the admin panel.</p>

    <div class="info-box" style="border-left: 4px solid #007bff;">
        <h3>ğŸ’° Withdrawal Details</h3>
        <table class="info-table">
            <tr>
                <td class="label">User:</td>
                <td class="value"><strong>{{ user.get_full_name|default:user.username }}</strong> ({{ user.email }})
                </td>
            </tr>
            <tr>
                <td class="label">Amount:</td>
                <td class="value"><span class="amount" style="color: #007bff; font-size: 1.2em;">R{{
                        amount|floatformat:2 }}</span></td>
            </tr>
            <tr>
                <td class="label">Payment Method:</td>
                <td class="value">{{ payment_method }}</td>
            </tr>
            <tr>
                <td class="label">Status:</td>
                <td class="value"><span class="badge"
                        style="background: #ffc107; color: #000; padding: 4px 8px; border-radius: 4px;">Pending
                        Review</span></td>
            </tr>
            <tr>
                <td class="label">Submitted:</td>
                <td class="value">{{ withdrawal.created_at|date:"M d, Y H:i" }}</td>
            </tr>
            <tr>
                <td class="label">Withdrawal ID:</td>
                <td class="value">#{{ withdrawal.id }}</td>
            </tr>
        </table>
    </div>

    {% if withdrawal.payment_method == 'bank' %}
    <div class="info-box">
        <h3>ğŸ›ï¸ Bank Transfer Details</h3>
        <table class="info-table">
            {% if withdrawal.account_holder_name %}
            <tr>
                <td class="label">Account Holder:</td>
                <td class="value">{{ withdrawal.account_holder_name }}</td>
            </tr>
            {% endif %}
            {% if withdrawal.bank_name %}
            <tr>
                <td class="label">Bank:</td>
                <td class="value">{{ withdrawal.bank_name }}</td>
            </tr>
            {% endif %}
            {% if withdrawal.account_number %}
            <tr>
                <td class="label">Account Number:</td>
                <td class="value">{{ withdrawal.account_number }}</td>
            </tr>
            {% endif %}
            {% if withdrawal.branch_code %}
            <tr>
                <td class="label">Branch Code:</td>
                <td class="value">{{ withdrawal.branch_code }}</td>
            </tr>
            {% endif %}
            {% if withdrawal.account_type %}
            <tr>
                <td class="label">Account Type:</td>
                <td class="value">{{ withdrawal.account_type }}</td>
            </tr>
            {% endif %}
        </table>
    </div>
    {% endif %}

    <div class="info-box" style="border-left: 4px solid #28a745;">
        <h3>ğŸ‘¤ User Information</h3>
        <table class="info-table">
            <tr>
                <td class="label">Full Name:</td>
                <td class="value">{{ user.get_full_name|default:"Not provided" }}</td>
            </tr>
            <tr>
                <td class="label">Email:</td>
                <td class="value">{{ user.email }}</td>
            </tr>
            <tr>
                <td class="label">Phone:</td>
                <td class="value">{{ user.phone|default:"Not provided" }}</td>
            </tr>
            <tr>
                <td class="label">Join Date:</td>
                <td class="value">{{ user.date_joined|date:"M d, Y" }}</td>
            </tr>
            <tr>
                <td class="label">Email Verified:</td>
                <td class="value">{% if user.is_email_verified %}âœ… Yes{% else %}âŒ No{% endif %}</td>
            </tr>
        </table>
    </div>

    <div style="text-align: center; margin: 30px 0;">
        <a href="{{ admin_panel_url }}withdrawal/{{ withdrawal.id }}/change/" class="btn"
            style="background: #007bff; color: white; padding: 12px 24px; text-decoration: none; border-radius: 6px; display: inline-block; margin: 5px;">
            ğŸ” Review Withdrawal
        </a>
        <a href="{{ admin_panel_url }}withdrawal/" class="btn"
            style="background: #28a745; color: white; padding: 12px 24px; text-decoration: none; border-radius: 6px; display: inline-block; margin: 5px;">
            ğŸ“‹ All Withdrawals
        </a>
    </div>

    <div class="info-box">
        <h3>âš¡ Quick Actions Available in Admin Panel</h3>
        <ul style="margin: 15px 0; padding-left: 20px;">
            <li><strong>âœ… Approve:</strong> Process withdrawal and deduct funds from user's wallet</li>
            <li><strong>âŒ Reject:</strong> Decline withdrawal and notify user with reason</li>
            <li><strong>ğŸ“ Add Notes:</strong> Add internal notes for record keeping</li>
            <li><strong>ğŸ“Š View History:</strong> See all withdrawals from this user</li>
        </ul>
    </div>

    <p style="margin-top: 30px;">Please review this withdrawal request at your earliest convenience. Users are notified
        when their withdrawals are approved or rejected.</p>

    <p>Best regards,<br><strong>{{ app_name|default:"CapitalX" }} Platform System</strong></p>
</div>
{% endblock %}