# Bot Authentication System Guide

This guide explains how to use the secure bot authentication system that uses secret passwords/phrases for API authentication.

## Overview

The bot authentication system provides a secure way for bots to access financial information without exposing personal user credentials. Instead of using traditional username/password authentication, bots use a secret passphrase that is generated by the user and used for all subsequent API calls.

## How It Works

1. **Secret Generation**: Users generate a secret passphrase through the web interface
2. **Secret Storage**: The secret is stored securely in the user's profile
3. **API Authentication**: Bots use the secret in API requests to authenticate
4. **Data Access**: Authenticated bots can access financial information

## API Endpoints

### 1. Generate Bot Secret
**Endpoint**: `POST /api/generate-bot-secret/`
**Authentication**: Requires user login session
**Description**: Generates a new bot secret for the authenticated user

**Response**:
```json
{
  "success": true,
  "secret": "generated_secret_string",
  "message": "Bot secret generated successfully. Keep this secret safe!"
}
```

### 2. Validate Bot Secret
**Endpoint**: `POST /api/validate-bot-secret/`
**Authentication**: None (public endpoint)
**Description**: Validates if a bot secret is valid

**Request**:
```json
{
  "secret": "bot_secret_to_validate"
}
```

**Response**:
```json
{
  "success": true,
  "valid": true,
  "user": {
    "id": 1,
    "username": "user123",
    "email": "user@example.com"
  }
}
```

### 3. Get Financial Information
**Endpoint**: `POST /api/bot/financial-info/`
**Authentication**: Uses bot secret
**Description**: Returns financial information for the user associated with the secret

**Request**:
```json
{
  "secret": "bot_secret"
}
```

**Response**:
```json
{
  "success": true,
  "user": {
    "username": "user123",
    "email": "user@example.com"
  },
  "wallet": {
    "balance": 1500.00
  },
  "investments": {
    "active": [
      {
        "id": 1,
        "company": "Tech Corp",
        "amount": 1000.00,
        "return_amount": 1200.00,
        "start_date": "2023-01-01T00:00:00Z",
        "end_date": "2023-12-31T00:00:00Z",
        "days_remaining": 45
      }
    ],
    "total_active_amount": 1000.00
  },
  "plan_investments": {
    "active": [],
    "total_active_amount": 0.00
  },
  "recent_deposits": [
    {
      "id": 1,
      "amount": 500.00,
      "payment_method": "Bitcoin",
      "created_at": "2023-06-01T10:30:00Z"
    }
  ],
  "recent_withdrawals": [
    {
      "id": 1,
      "amount": 200.00,
      "payment_method": "Bank Transfer",
      "status": "approved",
      "created_at": "2023-05-15T14:20:00Z"
    }
  ],
  "summary": {
    "total_balance": 1500.00,
    "total_active_investments": 1000.00,
    "total_plan_investments": 0.00
  }
}
```

## Security Best Practices

1. **Keep Secrets Safe**: Never commit bot secrets to version control
2. **Environment Variables**: Store secrets in environment variables
3. **Regular Rotation**: Rotate secrets periodically
4. **HTTPS Only**: Always use HTTPS for API calls
5. **Error Handling**: Implement proper error handling in your bot

## Example Bot Implementation

See `bot_authentication_example.py` for a complete example implementation.

## Troubleshooting

### Common Issues

1. **Invalid Secret**: Make sure the secret was generated correctly and hasn't been rotated
2. **Network Errors**: Check your internet connection and API endpoint URL
3. **Server Errors**: Check server logs for detailed error information

### Getting Help

If you encounter issues with the bot authentication system, please:
1. Check the server logs
2. Verify your secret is correct
3. Ensure you're using the correct API endpoints
4. Contact support if problems persist